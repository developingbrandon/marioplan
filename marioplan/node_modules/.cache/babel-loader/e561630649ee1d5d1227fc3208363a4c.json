{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: !0\n}), exports.default = useFirebaseConnect;\n\nvar _differenceWith2 = _interopRequireDefault(require(\"lodash/differenceWith\")),\n    _isEqual2 = _interopRequireDefault(require(\"lodash/isEqual\")),\n    _react = require(\"react\"),\n    _query = require(\"./actions/query\"),\n    _utils = require(\"./utils\"),\n    _useFirebase = _interopRequireDefault(require(\"./useFirebase\"));\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction useFirebaseConnect(queriesConfig) {\n  var firebase = (0, _useFirebase.default)(),\n      eventRef = (0, _react.useRef)(),\n      dataRef = (0, _react.useRef)(),\n      data = (0, _react.useMemo)(function () {\n    return (0, _utils.invokeArrayQuery)(queriesConfig);\n  }, [queriesConfig]);\n  (0, _react.useEffect)(function () {\n    if (null !== data && !(0, _isEqual2.default)(data, dataRef.current)) {\n      var itemsToSubscribe = (0, _differenceWith2.default)(data, dataRef.current, _isEqual2.default),\n          itemsToUnsubscribe = (0, _differenceWith2.default)(dataRef.current, data, _isEqual2.default);\n      dataRef.current = data, (0, _query.unWatchEvents)(firebase, firebase.dispatch, (0, _utils.getEventsFromInput)(itemsToUnsubscribe)), eventRef.current = (0, _utils.getEventsFromInput)(data), (0, _query.watchEvents)(firebase, firebase.dispatch, (0, _utils.getEventsFromInput)(itemsToSubscribe));\n    }\n  }, [data]), (0, _react.useEffect)(function () {\n    return function () {\n      (0, _query.unWatchEvents)(firebase, firebase.dispatch, eventRef.current);\n    };\n  }, []);\n}\n\nmodule.exports = exports.default;","map":null,"metadata":{},"sourceType":"script"}